<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>我的技术与生活——redis操作 | Mr.Long</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/imgs/shortcut-icon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/public.css" />
  <link rel="stylesheet" href="/css/layout.css" />
  <link rel="stylesheet" href="/css/iconfont.css" />
  <link rel="stylesheet" href="/css/APlayer.min.css" />
  <script src="/js/APlayer.min.js"></script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/jquery.pjax.min.js"></script>

  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script>
    document.title = `我的技术与生活——redis操作`
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>

<style>
  .load {
    width: 100%;
    height: 100vh;
    background-color: rgb(37, 35, 40);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 9999;
  }
  .load-circle {
    width: 80px;
    height: 80px;
    border: 8px solid orange;
    border-bottom-color: transparent;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    animation: rotate 1s linear infinite;
    filter: drop-shadow(0 0 3px orange);
  }
  .load-circle-inner {
    width: 40px;
    height: 40px;
    border: 8px solid orange;
    border-top-color: transparent;
    border-radius: 50%;
    animation: rotate-reverse .5s linear infinite;
  }
  .load-text {
    margin-top: 20px;
    font-size: 24px;
    color: orange;
    display: flex;
  }
  .load-text span {
    margin: 0 5px;
    text-shadow: 5px 5px 5px orange;
    animation: move 1s linear infinite;
  }
  .load-text span:nth-child(1) {
    animation-delay: -0.6s;
  }
  .load-text span:nth-child(2) {
    animation-delay: -0.5s;
  }
  .load-text span:nth-child(3) {
    animation-delay: -0.4s;
  }
  .load-text span:nth-child(4) {
    animation-delay: -0.3s;
  }
  .load-text span:nth-child(5) {
    animation-delay: -0.2s;
  }
  .load-text span:nth-child(6) {
    animation-delay: -0.1s;
  }
  @keyframes rotate {
    0% { transform: rotate(0); }
    100% { transform: rotate(360deg); }
  }
  @keyframes rotate-reverse {
    0% { transform: rotate(0); }
    100% { transform: rotate(-360deg); }
  }
  @keyframes move {
    0% { transform: translateY(0%) rotate(0) scale(1); }
    20% { transform: translateY(20%) rotate(10deg) scale(1.2); }
    80% { transform: translateY(-10%) rotate(-20deg) scale(.8);}
    100% { transform: translateY(0) rotate(0) scale(1); }
  }

  .progress {
    position: fixed;
    left: 0; top: 0;
    width: 0;
    height: 3px;
    background-color: green;
    transition: all cubic-bezier(0.215, 0.610, 0.355, 1) .1s;
    z-index: 9999;
  }

  .to-up {
    animation: toUp .5s 1;
  }
  .gray {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100vh;
    z-index: 9999;
    display: none;
    pointer-events: none;
    background-color: #000;
    mix-blend-mode: color;
  }
  @keyframes toUp {
    from { transform: translateY(15px); opacity: 0; }
    to { transform: translateY(0) ; opacity: 1; }
  }
</style>
<body>
  <div id="load" class="load">
    <div class="load-circle">
      <div class="load-circle-inner"></div>
    </div>
    <p class="load-text">
      <span>L</span>
      <span>O</span>
      <span>A</span>
      <span>D</span>
      <span>I</span>
      <span>N</span>
      <span>G</span>
    </p>
  </div>
  <div id="container" class="container w-100 vh-100" style="display: none;">
    <header class="header">
  <div class="header-wrapper">
    <div class="header-left">
      <div class="header-search">
        <input id="search-input" type="text" class="header-search--input" placeholder="请输入要检索的文章标题" />
        <span id="search-btn" class="header-search--icon"><i class="iconfont icon-sousuo"></i></span>
      </div>
      <div id="search-layer" class="header-search--layer hidden">
        <p class="title">
          <span>以下是搜索内容：</span>
          <span id="close-layer-btn">关闭</span>
        </p>
        <ul>
        </ul>
      </div>
    </div>
    <div class="header-right">
      <ul class="header-menu">
        <li>
          <a href="http://example.com/">
            <i class="header-menu--icon iconfont icon-shouye"></i>
            <span class="header-menu--span">首页</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/log">
            <i class="header-menu--icon iconfont icon-rizhi"></i>
            <span class="header-menu--span">日志</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/link">
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
            <span class="header-menu--span">友情链接</span>
          </a>
        </li>
        <li>
          <a href="http://example.com/about">
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
            <span class="header-menu--span">关于我</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</header>

<script>
  const ipt = document.querySelector('#search-input')
  const btn = document.querySelector('#search-btn')
  const layer = document.querySelector('#search-layer')
  const posts = JSON.parse(`[{"title":"docker命令","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/21/Docker命令大全/"},{"title":"LV移除、缩容","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/d733537fd3e06784932826b5e82a855d","path":"2023/06/14/LV逻辑卷扩展/"},{"title":"PXE+Kickstart无人值守安装操作系统","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/82cb48f718f8acc8cb2568140eeaaec382cb48f718f8acc8cb2568140eeaaec3","path":"2023/06/26/PXE+Kickstart无人值守安装操作系统/"},{"title":"PQL","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/240007b00ab1bcd1e3af7bb55f18a966","path":"2024/06/30/PromQL 讲解/"},{"title":"TCP协议","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/15047394039467328","path":"2023/06/23/TCP协议/"},{"title":"ansible模块","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/1e624a7ba7e09f195b3f2f384b2b9bb1","path":"2023/08/17/ansible 模块扩展/"},{"title":"docker容器","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/11/docker容器/"},{"title":"FTP文件服务器","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/a9045286aa9b50dcc09302eff83b328a","path":"2023/06/23/ftp/"},{"title":"Galera集群","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/3719037aa1a43c4806d84ac9bd3dbc34","path":"2024/07/26/galera/"},{"title":"nginx1","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/8c29198625ff99eee0073bbbb137bbc78c29198625ff99eee0073bbbb137bbc7","path":"2023/12/17/nginx1/"},{"title":"nginx2","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/8c29198625ff99eee0073bbbb137bbc78c29198625ff99eee0073bbbb137bbc7","path":"2023/12/19/nginx2/"},{"title":"nginx5","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/8c29198625ff99eee0073bbbb137bbc78c29198625ff99eee0073bbbb137bbc7","path":"2023/12/31/nnginx5/"},{"title":"","path":"2024/09/01/prometheus 监控/"},{"title":"","path":"2024/09/01/redis集群/"},{"title":"","path":"2024/09/01/shell脚本/"},{"title":"docker安装","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/06/容器技术-Docker1/"},{"title":"docker镜像容器","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/14/容器技术-docker2/"},{"title":"docker-Compose","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/21/容器技术-docker5/"},{"title":"prometheus-exporter","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/240007b00ab1bcd1e3af7bb55f18a966","path":"2024/06/16/node_exporter/"},{"title":"shell编程","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/9217d5c6d87ce0e8ec7422ca7469db95","path":"2023/07/21/shell_newrain/"},{"title":"docker资源限制","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/15/容器技术docker4/"},{"title":"用户文件权限","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/3719037aa1a43c4806d84ac9bd3dbc34","path":"2023/06/01/文件权限/"},{"title":"单用户模式破解密码","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/3f6ae566e1f093d2d9dbcc3df361fc4b3f6ae566e1f093d2d9dbcc3df361fc4b","path":"2023/07/01/破解密码/"},{"title":"磁盘阵列","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/69d9906ff9bf88dbc02184ecb8504fc5","path":"2023/07/09/磁盘阵列RAID/"},{"title":"linux文件管理","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/de0f7b079a80d192f90989d9c2c9622d","path":"2023/06/21/文件管理/"},{"title":"存储管理--1","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/d733537fd3e06784932826b5e82a855d","path":"2023/06/25/磁盘存储管理1/"},{"title":"自建YUM源","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/56260873f5720f373c20f43587eab0b8","path":"2023/06/21/自建yum源笔记/"},{"title":"prometheus自定义监控","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/240007b00ab1bcd1e3af7bb55f18a966","path":"2024/06/26/自定义监控/"},{"title":"Linux网卡","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/346f59e468f2155074d1fb3164594702","path":"2023/06/11/网络管理基础/"},{"title":"微服务","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/3719037aa1a43c4806d84ac9bd3dbc34","path":"2024/07/26/微服务概念/"},{"title":"走进网络世界","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/583716b0cb306203c308cc0def55dd9e583716b0cb306203c308cc0def55dd9e","path":"2023/06/16/走进网络世界/"},{"title":"docker容器","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/71e27d1e01da8c13f3f165a1c3bcc8b571e27d1e01da8c13f3f165a1c3bcc8b5","path":"2024/03/13/容器技术-docker3/"},{"title":"nginx4","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/8c29198625ff99eee0073bbbb137bbc78c29198625ff99eee0073bbbb137bbc7","path":"2023/12/30/nginx4/"},{"title":"nginx3","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/8c29198625ff99eee0073bbbb137bbc78c29198625ff99eee0073bbbb137bbc7","path":"2023/12/22/nginx3/"},{"title":"微服务项目","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/3719037aa1a43c4806d84ac9bd3dbc34","path":"2024/07/26/微服务项目-mall-swarm/"},{"title":"redis操作","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/a13d778b5db38e4b127b71bdf122f695","path":"2023/09/26/Redis操作/"},{"title":"LVM逻辑卷管理","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/d733537fd3e06784932826b5e82a855d","path":"2023/06/28/LVM逻辑卷管理/"},{"title":"python一","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/15096963228077376","path":"2024/02/20/Python1/"},{"title":"python四","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/15096963228077376","path":"2024/03/01/Python4/"},{"title":"python二","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/15096963228077376","path":"2024/02/21/Python2/"},{"title":"python三","cover":"https://haowallpaper.com/link/common/file/getCroppingImg/15096963228077376","path":"2024/02/25/Python3/"}]`)
  ipt.addEventListener('keyup', e => {
    if (e.key === 'Enter') {
      handleSearch()
    }
  })
  btn.addEventListener('click', () => {
    handleSearch()
  })

  document.querySelector('#close-layer-btn').addEventListener('click', () => {
    layer.classList.toggle('hidden')
  })

  function handleSearch() {
    if (ipt.value.trim() === '') {
      return
    }
    let html = ''
    const targetPosts = posts.filter(post => post.title.includes(ipt.value))
    targetPosts.forEach(post => {
      html += `
        <li>
          <div>
            <a href="/${post.path}">${post.title.replace(new RegExp(ipt.value), `<span>${ipt.value}</span>`)}</a>
          </div>
          <img src="${post.cover || '/imgs/default-cover.webp' }" />
        </li>
      `
    })
    if (html.trim () === '') {
      html += '<p class="empty">没有搜索到内容</p>'
    }
    layer.querySelector('ul').innerHTML = html
    layer.classList.remove('hidden')
  }
</script> 
    <section id="main" class="main">
      <div class="main-left-wrapper">
<div class="main-left">
  <div class="main-left--block">
    <div class="main-left--info">
      <img src="/imgs/avatar.jpg"" class="main-left--avatar" />
      <div class="main-left--intro">
        <p class="main-left--name">Mr.Long</p>
        <div class="main-left--tags">
          <span class="main-left--tag">唱跳rap篮球</span>
          <span class="main-left--tag">宅但不肥</span>
        </div>
      </div>
    </div>
  
    <div>
      <div class="main-left--motto">
        <p>“花有重开日，人无再少年”</p>
        <p>“一个简单普通的男孩”</p>
      </div>
      <div class="main-left--github">
        <span class="line"></span>
        <a target="_blank" rel="noopener" href="https://github.com/MyRong99/MyRong99.github.io"><i class="logo iconfont icon-github-fill"></i></a>
        <span class="line"></span>
      </div>
      <div class="main-left--statics">
        <a href="/categories">
          <div>
            <span>6</span>
            <span>分类</span>
          </div>
        </a>
        <a href="/tags">
          <div>
            <span>7</span>
            <span>标签</span>
          </div>
        </a>
        <a href="/archives">
          <div>
            <span>10 </span>
            <span>归档</span>
          </div>
        </a>
      </div>
    </div>
  </div>

  <div class="main-left--block">
    <ul class="main-left--menu">
      
        <li>
          <a href="/">
            <span class="header-menu--span">小站首页</span>
            <i class="header-menu--icon iconfont icon-shouye"></i>
          </a>
        </li>
      
        <li>
          <a href="/log">
            <span class="header-menu--span">个人日志</span>
            <i class="header-menu--icon iconfont icon-rizhi"></i>
          </a>
        </li>
      
        <li>
          <a href="/link">
            <span class="header-menu--span">友情链接</span>
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
          </a>
        </li>
      
        <li>
          <a href="/about">
            <span class="header-menu--span">关于自己</span>
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
          </a>
        </li>
      
        <li>
          <a href="/tools">
            <span class="header-menu--span">我的工具</span>
            <i class="header-menu--icon iconfont icon-gongju"></i>
          </a>
        </li>
      
    </ul>
  </div>

  <div class="main-left--block">
    <div class="main-left--site">
      <h5 class="main-left--title">
        <span>站点信息</span>
        <i class="iconfont icon-zhandian"></i>
      </h5>
      <p class="main-left--subtitle">
        <span>文章数目：</span>
        <span>41 篇</span>
      </p>
      <p class="main-left--subtitle">
        <span>最近动态：</span>
        <span>今天</span>
      </p>
      <p class="main-left--subtitle">
        <span>上线时间：</span>
        <span>439天</span>
      </p>
      <p class="main-left--subtitle">
        <span>当前版本：</span>
        <span>v1.0.2</span>
      </p>
    </div>
  </div>
</div></div>
      <div id="main-container" class="main-container">


  <link rel="stylesheet" href="/css/partial/article.css" />

<div class="article-container">
  <div class="article">
    <h1 class="article-title">redis操作</h1>
    <div class="article-info">
      <div class="article-info--item">
        <div class="article-info--info">
          
          <div class="article-info--categories">
            <span>分类：</span>
            <a class="category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">-中间件</a>
          </div>
          
          
          <div class="article-info--tags">
            <span>标签：</span>
            <a class="tag-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">-中间件</a>
          </div>
          
          <p class="article-info--date">日期：2023-09-26 11:15:33</p>
        </div>
        <img src="https://haowallpaper.com/link/common/file/getCroppingImg/a13d778b5db38e4b127b71bdf122f695" alt="" class="article-cover">
      </div>
    </div>
    <article class="article-content markdown-body">
      <h3 id="Python3-操作-Redis"><a href="#Python3-操作-Redis" class="headerlink" title="Python3 操作 Redis"></a>Python3 操作 Redis</h3><h4 id="1、简单介绍"><a href="#1、简单介绍" class="headerlink" title="1、简单介绍"></a>1、简单介绍</h4><p>redis是一个key-value存储系统，和Memcached类似。它支持存储的value类型相对更多，包括string(字符串)、list(链表、set(集合)、zset(sorted set –有序集合)和hash（哈希类型）。</p>
<p>这些数据类型都支持push&#x2F;pop、add&#x2F;remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。在此基础上，redis支持各种不同方式的排序。</p>
<p>与memcached一样，为了保证效率，数据都是缓存在内存中。区别的是redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 使用Redis有哪些好处？</span><br><span class="line">(1) 速度快，因为数据存在内存中，类似于HashMap，HashMap的优势就是查找和操作的时间复杂度都是O(1)</span><br><span class="line">(2) 支持丰富数据类型，支持string，list，set，sorted set，hash</span><br><span class="line">(3) 支持事务，操作都是原子性，所谓的原子性就是对数据的更改要么全部执行，要么全部不执行</span><br><span class="line">(4) 丰富的特性：可用于缓存，消息，按key设置过期时间，过期后将会自动删除</span><br></pre></td></tr></table></figure>

<h4 id="2、安装-redis-软件"><a href="#2、安装-redis-软件" class="headerlink" title="2、安装 redis 软件"></a>2、安装 redis 软件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install redis      #需要epel源</span><br><span class="line">systemctl start redis</span><br></pre></td></tr></table></figure>

<p><strong>命令列表</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis-server                # Redis 服务器</span><br><span class="line">redis-cli                   # Redis 自带的客户端</span><br><span class="line">redis-benchmark             # Redis 性能测试工具</span><br><span class="line">redis-check-aof             # AOF 文件修复工具</span><br></pre></td></tr></table></figure>

<p><strong>Redis 默认监听 6379 端口</strong></p>
<h4 id="3、Redis-命令"><a href="#3、Redis-命令" class="headerlink" title="3、Redis 命令"></a>3、Redis 命令</h4><p>Redis 命令用于在 redis 服务上执行操作。</p>
<p>要在 redis 服务上执行命令需要一个 redis 客户端。Redis 客户端在我们之前下载的的 redis 的安装包中。</p>
<p>语法</p>
<p>Redis 客户端的基本语法为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli</span><br></pre></td></tr></table></figure>

<p>以下实例讲解了如何启动 redis 客户端：</p>
<p>启动 redis 客户端，打开终端并输入命令 <strong>redis-cli</strong>。该命令会连接本地的 redis 服务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$redis-cli</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br><span class="line">redis 127.0.0.1:6379&gt; PING</span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<p>在以上实例中我们连接到本地的 redis 服务并执行 <strong>PING</strong> 命令，该命令用于检测 redis 服务是否启动。</p>
<hr>
<h5 id="在远程服务上执行命令"><a href="#在远程服务上执行命令" class="headerlink" title="在远程服务上执行命令"></a>在远程服务上执行命令</h5><p>如果需要在远程 redis 服务上执行命令，同样我们使用的也是 <strong>redis-cli</strong> 命令。</p>
<p>语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h host -p port -a password</span><br></pre></td></tr></table></figure>

<p>以下实例演示了如何连接到主机为 127.0.0.1，端口为 6379 ，密码为 mypass 的 redis 服务上。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$redis-cli -h 127.0.0.1 -p 6379 -a &quot;mypass&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br><span class="line">redis 127.0.0.1:6379&gt; PING</span><br><span class="line"></span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<h4 id="4、Redis-数据类型"><a href="#4、Redis-数据类型" class="headerlink" title="4、Redis 数据类型"></a>4、Redis 数据类型</h4><p>Redis支持五种数据类型：string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)。</p>
<hr>
<h5 id="1、String（字符串）"><a href="#1、String（字符串）" class="headerlink" title="1、String（字符串）"></a>1、String（字符串）</h5><p>string 是 redis 最基本的类型，你可以理解成与 Memcached 一模一样的类型，一个 key 对应一个 value。</p>
<p>string 类型是二进制安全的。意思是 redis 的 string 可以包含任何数据。比如jpg图片或者序列化的对象。</p>
<p>string 类型是 Redis 最基本的数据类型，string 类型的值最大能存储 512MB。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SET name &quot;qianfeng&quot;</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; GET name</span><br><span class="line">&quot;qianfeng&quot;</span><br></pre></td></tr></table></figure>

<p>在以上实例中我们使用了 Redis 的 <strong>SET</strong> 和 <strong>GET</strong> 命令。键为 name，对应的值为 <strong>qianfeng</strong>。</p>
<p><strong>注意：</strong>一个键最大能存储512MB。</p>
<hr>
<h5 id="2、Hash（哈希）"><a href="#2、Hash（哈希）" class="headerlink" title="2、Hash（哈希）"></a>2、Hash（哈希）</h5><p>Redis hash 是一个键值(key&#x3D;&gt;value)对集合。</p>
<p>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。</p>
<p><strong>DEL qianfeng</strong> 用于删除前面测试用过的 key，不然会报错：**(error) WRONGTYPE Operation against a key holding the wrong kind of value**</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; DEL qianfeng</span><br><span class="line">redis 127.0.0.1:6379&gt; HMSET myhash field1 &quot;Hello&quot; field2 &quot;World&quot;</span><br><span class="line">&quot;OK&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt; HGET myhash field1</span><br><span class="line">&quot;Hello&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt; HGET myhash field2</span><br><span class="line">&quot;World&quot;</span><br></pre></td></tr></table></figure>

<p>实例中我们使用了 Redis <strong>HMSET, HGET</strong> 命令，<strong>HMSET</strong> 设置了两个 <strong>field&#x3D;&gt;value</strong> 对, HGET 获取对应 <strong>field</strong> 对应的 <strong>value</strong>。</p>
<p>每个 hash 可以存储 2**32-1 键值对（40多亿）。</p>
<h5 id="3、List（列表）"><a href="#3、List（列表）" class="headerlink" title="3、List（列表）"></a>3、List（列表）</h5><p>Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; lpush qianfeng redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush qianfeng mongodb</span><br><span class="line">(integer) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush qianfeng rabitmq</span><br><span class="line">(integer) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange qianfeng 0 10</span><br><span class="line">1) &quot;rabitmq&quot;</span><br><span class="line">2) &quot;mongodb&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>

<p>在以上实例中我们使用了 <strong>LPUSH</strong> 将三个值插入了名为 <strong>qianfeng</strong> 的列表当中。</p>
<p>列表最多可存储 2^32 - 1 元素 (4294967295, 每个列表可存储40多亿)。</p>
<h5 id="4、Set（集合）"><a href="#4、Set（集合）" class="headerlink" title="4、Set（集合）"></a>4、Set（集合）</h5><p>Redis的Set是string类型的无序集合。</p>
<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是0(1)。</p>
<h6 id="1、sadd-命令"><a href="#1、sadd-命令" class="headerlink" title="1、sadd 命令"></a>1、sadd 命令</h6><p>添加一个 string 元素到 key 对应的 set 集合中，成功返回1，如果元素已经在集合中返回 0，如果 key 对应的 set 不存在则返回错误。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sadd key member</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; sadd qianfeng1 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd qianfeng1 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd qianfeng1 rabitmq</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd qianfeng1 rabitmq</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers qianfeng1</span><br><span class="line"></span><br><span class="line">1) &quot;redis&quot;</span><br><span class="line">2) &quot;rabitmq&quot;</span><br><span class="line">3) &quot;mongodb&quot;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>以上实例中 rabitmq 添加了两次，但根据集合内元素的唯一性，第二次插入的元素将被忽略。</p>
<p>集合中最大的成员数为 2**32 - 1(4294967295, 每个集合可存储40多亿个成员)。</p>
<h5 id="5、zset-sorted-set：有序集合"><a href="#5、zset-sorted-set：有序集合" class="headerlink" title="5、zset(sorted set：有序集合)"></a>5、zset(sorted set：有序集合)</h5><p>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。</p>
<p>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>
<p>有序集合的成员是唯一的,但分数(score)却可以重复。</p>
<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">double 和 float 的区别是 double精度高，有效数字16位，float精度7位。但double消耗内存是float的两倍，double的运算速度比float慢得多</span><br></pre></td></tr></table></figure>

<h6 id="1、zadd-命令"><a href="#1、zadd-命令" class="headerlink" title="1、zadd 命令"></a>1、zadd 命令</h6><p>添加元素到集合，元素在集合中存在则更新对应score</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zadd key score member </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; ZADD qianfengkey 1 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD qianfengkey 2 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD qianfengkey 3 mysql</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD qianfengkey 3 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZADD qianfengkey 4 mysql</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; ZRANGE qianfengkey 0 10 WITHSCORES</span><br><span class="line"></span><br><span class="line">1) &quot;redis&quot;</span><br><span class="line">2) &quot;1&quot;</span><br><span class="line">3) &quot;mongodb&quot;</span><br><span class="line">4) &quot;2&quot;</span><br><span class="line">5) &quot;mysql&quot;</span><br><span class="line">6) &quot;4&quot;</span><br></pre></td></tr></table></figure>

<p>在以上实例中我们通过命令 <strong>ZADD</strong> 向 redis 的有序集合中添加了三个值并关联上分数。</p>
<h4 id="5、Python-操作-Redis"><a href="#5、Python-操作-Redis" class="headerlink" title="5、Python 操作 Redis"></a>5、Python 操作 Redis</h4><p>所见即所得的东西，讲一部分，其他按照笔记看。不要求都掌握。</p>
<h5 id="1、安装包"><a href="#1、安装包" class="headerlink" title="1、安装包"></a>1、安装包</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install redis</span><br></pre></td></tr></table></figure>

<h5 id="2、连接"><a href="#2、连接" class="headerlink" title="2、连接"></a>2、连接</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: r = redis.Redis(host=<span class="string">&#x27;10.18.42.174&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: r.<span class="built_in">set</span>(<span class="string">&quot;QF&quot;</span>, <span class="string">&quot;www.qfedu.com&quot;</span>)</span><br><span class="line">Out[<span class="number">3</span>]: <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">In [<span class="number">4</span>]: r.get(<span class="string">&quot;QF&quot;</span>)</span><br><span class="line">Out[<span class="number">4</span>]: <span class="string">b&#x27;www.qfedu.com&#x27;</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: ret = r.get(<span class="string">&quot;QF&quot;</span>)</span><br><span class="line">    </span><br><span class="line">In [<span class="number">6</span>]: ret.decode()</span><br><span class="line">Out[<span class="number">6</span>]: <span class="string">&#x27;www.qfedu.com&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="3、连接池"><a href="#3、连接池" class="headerlink" title="3、连接池"></a>3、连接池</h5><p>redis-py使用connection pool来管理对一个redis server的所有连接，避免每次建立、释放连接的开销。</p>
<p>默认，每个Redis实例都会维护一个自己的连接池。</p>
<p>可以直接建立一个连接池，然后作为参数传给Redis，这样就可以实现多个 Redis 实例共享一个连接池</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">12</span>]: pool = redis.ConnectionPool(host=<span class="string">&#x27;172.16.153.134&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">13</span>]: rs = redis.Redis(connection_pool=pool)</span><br><span class="line"></span><br><span class="line">In [<span class="number">14</span>]: rs.<span class="built_in">set</span>(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>)</span><br><span class="line">Out[<span class="number">14</span>]: <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">15</span>]: rs.get(<span class="string">&quot;foo&quot;</span>)</span><br><span class="line">Out[<span class="number">15</span>]: <span class="string">b&#x27;bar&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="4、基本操作"><a href="#4、基本操作" class="headerlink" title="4、基本操作"></a>4、基本操作</h5><ul>
<li><h5 id="String-操作"><a href="#String-操作" class="headerlink" title="String 操作"></a><strong>String 操作</strong></h5>redis中的 String 在内存中按照一个name对应一个value来存储</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>(name, value, ex=<span class="literal">None</span>, px=<span class="literal">None</span>, nx=<span class="literal">False</span>, xx=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>() </span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     在 Redis 中设置值，默认，不存在则创建，存在则修改</span></span><br><span class="line"><span class="string">       参数：</span></span><br><span class="line"><span class="string">             ex，过期时间（秒）</span></span><br><span class="line"><span class="string">             px，过期时间（毫秒）</span></span><br><span class="line"><span class="string">             nx，假如设置为True，则只有 name 不存在时，当前 set 操作才执行</span></span><br><span class="line"><span class="string">             xx，假如设置为True，则只有 name 存在时，当前 set 操作才执行</span></span><br><span class="line"><span class="string">     &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">setnx(name, value)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 设置值，只有name不存在时，执行设置操作（添加）</span></span><br><span class="line">    </span><br><span class="line">setex(name, time, value)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 设置值</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     time，过期时间（数字秒）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">psetex(name, time_ms, value)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 设置值</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     time_ms，过期时间（数字毫秒）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">mset(*args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">批量设置值：</span></span><br><span class="line"><span class="string">    mset(QF=&#x27;www.qfedu.com&#x27;, yangge=&#x27;杨哥&#x27;)</span></span><br><span class="line"><span class="string">    或</span></span><br><span class="line"><span class="string">    mget(&#123;&#x27;k1&#x27;: &#x27;v1&#x27;, &#x27;k2&#x27;: &#x27;v2&#x27;&#125;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">get(name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取值</span></span><br><span class="line">    </span><br><span class="line">mget(keys, *args)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">批量获取：</span></span><br><span class="line"><span class="string">    mget(&#x27;QF&#x27;, &#x27;foo&#x27;)</span></span><br><span class="line"><span class="string">    或</span></span><br><span class="line"><span class="string">    mget([&#x27;QF&#x27;, &#x27;foo&#x27;])</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getset(name, value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置新值并获取原来的值</span></span><br><span class="line"></span><br><span class="line">getrange(key, start, end)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以字节的方式获取一部分值(一个汉字等于三个字节)</span></span><br><span class="line"></span><br><span class="line">setrange(name, offset, value)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">修改字符串内容，从指定字符串索引开始向后替换（新值太长时，则向后添加）</span></span><br><span class="line"><span class="string">参数：</span></span><br><span class="line"><span class="string">   offset  字符串的索引，字节方式</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">incr(<span class="variable language_">self</span>, name, amount=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 自增 name对应的值，当name不存在时，则创建 name＝amount，否则，则自增。</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name,Redis的name</span></span><br><span class="line"><span class="string">     amount,自增数（必须是整数）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">decr(<span class="variable language_">self</span>, name, amount=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 自减</span></span><br><span class="line"></span><br><span class="line">append(key, value)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在redis name对应的值后面追加内容</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h5 id="Hash-操作"><a href="#Hash-操作" class="headerlink" title="Hash 操作"></a><strong>Hash 操作</strong></h5></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">hset(name, key, value)</span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line">In [<span class="number">20</span>]: rs.hset(<span class="string">&quot;hs1&quot;</span>,<span class="string">&quot;k1&quot;</span>, <span class="string">&quot;v1&quot;</span>)</span><br><span class="line">Out[<span class="number">20</span>]: <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> name 对应的 hash 中设置一个键值对（不存在，则创建；否则，修改）</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis hash的name</span></span><br><span class="line"><span class="string">     key，name对应的hash中的key</span></span><br><span class="line"><span class="string">     value，name对应的hash中的value</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 注意：</span></span><br><span class="line"><span class="string">    # hsetnx(name, key, value),当name对应的hash中不存在当前key时则创建（相当于添加）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">hmset(name, mapping)</span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line">In [<span class="number">6</span>]: rs.hmset(<span class="string">&#x27;hs1&#x27;</span>, &#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;)</span><br><span class="line">Out[<span class="number">6</span>]: <span class="literal">True</span></span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">在name对应的hash中批量设置键值对，没有的 key 就创建，已存在的 key 修改</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     mapping，字典，栗子：&#123;&#x27;k1&#x27;:&#x27;v1&#x27;, &#x27;k2&#x27;: &#x27;v2&#x27;&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">hget(name,key)</span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line">In [<span class="number">8</span>]: rs.hget(<span class="string">&#x27;hs1&#x27;</span>,<span class="string">&#x27;k1&#x27;</span>)</span><br><span class="line">Out[<span class="number">8</span>]: <span class="string">b&#x27;v1&#x27;</span></span><br><span class="line"><span class="comment">#*************************</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在name对应的hash中获取根据key获取value</span></span><br><span class="line"></span><br><span class="line">hmget(name, keys, *args)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的hash中获取多个key的值</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，reids对应的name</span></span><br><span class="line"><span class="string">     keys，要获取key集合，栗子：[&#x27;k1&#x27;, &#x27;k2&#x27;, &#x27;k3&#x27;]</span></span><br><span class="line"><span class="string">     *args，要获取的key，栗子：k1,k2,k3</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 栗子：</span></span><br><span class="line"><span class="string">     r.mget(&#x27;xx&#x27;, [&#x27;k1&#x27;, &#x27;k2&#x27;])</span></span><br><span class="line"><span class="string">     或</span></span><br><span class="line"><span class="string">     r.hmget(&#x27;xx&#x27;, &#x27;k1&#x27;, &#x27;k2&#x27;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">################### 下面的自己搞 ########################</span></span><br><span class="line">hgetall(name)</span><br><span class="line"><span class="comment"># 获取name对应hash的所有键值</span></span><br><span class="line"></span><br><span class="line">hlen(name)</span><br><span class="line"><span class="comment"># 获取name对应的hash中键值对的个数</span></span><br><span class="line"></span><br><span class="line">hkeys(name)</span><br><span class="line"><span class="comment"># 获取name对应的hash中所有的key的值</span></span><br><span class="line"></span><br><span class="line">hvals(name)</span><br><span class="line"><span class="comment"># 获取name对应的hash中所有的value的值</span></span><br><span class="line"></span><br><span class="line">hexists(name, key)</span><br><span class="line"><span class="comment"># 检查name对应的hash是否存在当前传入的key</span></span><br><span class="line"></span><br><span class="line">hdel(name,*keys)</span><br><span class="line"><span class="comment"># 将name对应的hash中指定key的键值对删除</span></span><br><span class="line"></span><br><span class="line">hincrby(name, key, amount=<span class="number">1</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 自增name对应的hash中的指定key的值，不存在则创建key=amount</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis中的name</span></span><br><span class="line"><span class="string">     key， hash对应的key</span></span><br><span class="line"><span class="string">     amount，自增数（整数）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">hincrbyfloat(name, key, amount=<span class="number">1.0</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 自增name对应的hash中的指定key的值，不存在则创建key=amount</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis中的name</span></span><br><span class="line"><span class="string">     key， hash对应的key</span></span><br><span class="line"><span class="string">     amount，自增数（浮点数）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 更多 http://redisdoc.com/key/scan.html#scan</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h5 id="List-操作"><a href="#List-操作" class="headerlink" title="List 操作"></a><strong>List 操作</strong></h5></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">lpush(name,values)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的list中添加元素，每个新的元素都添加到列表的最左边</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 栗子：</span></span><br><span class="line"><span class="string">     r.lpush(&#x27;oo&#x27;, 11,22,33)</span></span><br><span class="line"><span class="string">     保存顺序为: 33,22,11</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 扩展：</span></span><br><span class="line"><span class="string">     rpush(name, values) 表示从右向左操作</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">lpushx(name,value)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的list中添加元素，只有name已经存在时，值添加到列表的最左边</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 更多：</span></span><br><span class="line"><span class="string">     rpushx(name, value) 表示从右向左操作</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">llen(name)</span><br><span class="line"><span class="comment"># name对应的list元素的个数</span></span><br><span class="line"></span><br><span class="line">linsert(name, where, refvalue, value))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的列表的某一个值前或后插入一个新值</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     where，BEFORE或AFTER</span></span><br><span class="line"><span class="string">     refvalue，标杆值，即：在它前后插入数据</span></span><br><span class="line"><span class="string">     value，要插入的数据</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">r.lset(name, index, value)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 对name对应的list中的某一个索引位置重新赋值</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     index，list的索引位置</span></span><br><span class="line"><span class="string">     value，要设置的值</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">r.lrem(name, value, num)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的list中删除指定的值</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     value，要删除的值</span></span><br><span class="line"><span class="string">     num，  num=0，删除列表中所有的指定值；</span></span><br><span class="line"><span class="string">            num=2,从前到后，删除2个；</span></span><br><span class="line"><span class="string">            num=-2,从后向前，删除2个</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">lpop(name)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的列表的左侧获取第一个元素并在列表中移除，返回值则是第一个元素</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 扩展：</span></span><br><span class="line"><span class="string">    # rpop(name) 表示从右向左操作</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">lindex(name, index)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">在name对应的列表中根据索引获取列表元素</span></span><br><span class="line"><span class="string">lrange(name, start, end)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> 在name对应的列表分片获取数据</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     start，索引的起始位置</span></span><br><span class="line"><span class="string">     end，索引结束位置</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">ltrim(name, start, end)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在name对应的列表中移除没有在start-end索引之间的值</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     start，索引的起始位置</span></span><br><span class="line"><span class="string">     end，索引结束位置</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">rpoplpush(src, dst)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 从一个列表取出最右边的元素，同时将其添加至另一个列表的最左边</span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     src，要取数据的列表的name</span></span><br><span class="line"><span class="string">     dst，要添加数据的列表的name</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">blpop(keys, timeout)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 将多个列表排列，按照从左到右去pop对应列表的元素</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     keys，redis的name的集合</span></span><br><span class="line"><span class="string">     timeout，超时时间，当元素所有列表的元素获取完之后，阻塞等待列表内有数据的时间（秒）, 0 表示永远阻塞</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 扩展：</span></span><br><span class="line"><span class="string">     r.brpop(keys, timeout)，从右向左获取数据</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">brpoplpush(src, dst, timeout=<span class="number">0</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 从一个列表的右侧移除一个元素并将其添加到另一个列表的左侧</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     src，取出并要移除元素的列表对应的name</span></span><br><span class="line"><span class="string">     dst，要插入元素的列表对应的name</span></span><br><span class="line"><span class="string">     timeout，当src对应的列表中没有数据时，阻塞等待其有数据的超时时间（秒），0 表示永远阻塞</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#########   自定义增量迭代 ######### </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 由于redis类库中没有提供对列表元素的增量迭代，假如想要循环name对应的列表的所有元素，那么就需要：</span></span><br><span class="line"><span class="string">     1、获取name对应的所有列表</span></span><br><span class="line"><span class="string">     2、循环列表</span></span><br><span class="line"><span class="string"> 但是，假如列表非常大，那么就有可能在第一步时就将程序的内容撑爆，所有有必要自定义一个增量迭代的功能：</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_iter</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    自定义redis列表增量迭代</span></span><br><span class="line"><span class="string">    :param name: redis中的name</span></span><br><span class="line"><span class="string">    :return: yield 返回 列表元素</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    list_count = r.llen(name)</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> xrange(list_count):</span><br><span class="line">        <span class="keyword">yield</span> r.lindex(name, index)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> list_iter(<span class="string">&#x27;pp&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<ul>
<li><h5 id="Set-操作"><a href="#Set-操作" class="headerlink" title="Set 操作"></a><strong>Set 操作</strong></h5>也是列表形式，但是其内的元素不允许重复</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">sadd(name,values)</span><br><span class="line"><span class="comment"># name对应的集合中添加元素</span></span><br><span class="line"></span><br><span class="line">scard(name)</span><br><span class="line"><span class="comment"># 获取name对应的集合中元素个数</span></span><br><span class="line"></span><br><span class="line">sdiff(keys, *args)</span><br><span class="line"><span class="comment"># 差集，在第一个name对应的集合中且不在其他name对应的集合的元素集合</span></span><br><span class="line"></span><br><span class="line">sdiffstore(dest, keys, *args)</span><br><span class="line"><span class="comment"># 获取第一个name对应的集合中且不在其他name对应的集合，再将其新加入到dest对应的集合中</span></span><br><span class="line"></span><br><span class="line">sinter(keys, *args)</span><br><span class="line"><span class="comment"># 获取一个name对应集合的交集</span></span><br><span class="line"></span><br><span class="line">sinterstore(dest, keys, *args)</span><br><span class="line"><span class="comment"># 获取多一个name对应集合的并集，再讲其加入到dest对应的集合中</span></span><br><span class="line"></span><br><span class="line">sismember(name, value)</span><br><span class="line"><span class="comment"># 检查value是不是name对应的集合的成员</span></span><br><span class="line"></span><br><span class="line">smembers(name)</span><br><span class="line"><span class="comment"># 获取name对应的集合的所有成员</span></span><br><span class="line"></span><br><span class="line">smove(src, dst, value)</span><br><span class="line"><span class="comment"># 将某个成员从一个集合中移动到另外一个集合</span></span><br><span class="line"></span><br><span class="line">spop(name)</span><br><span class="line"><span class="comment"># 从集合的右侧（尾部）移除一个成员，并将其返回</span></span><br><span class="line"></span><br><span class="line">srandmember(name, numbers)</span><br><span class="line"><span class="comment"># 从name对应的集合中随机获取 numbers 个元素</span></span><br><span class="line"></span><br><span class="line">srem(name, values)</span><br><span class="line"><span class="comment"># 在name对应的集合中删除某些值</span></span><br><span class="line"></span><br><span class="line">sunion(keys, *args)</span><br><span class="line"><span class="comment"># 获取多一个name对应的集合的并集</span></span><br><span class="line"></span><br><span class="line">sunionstore(dest,keys, *args)</span><br><span class="line"><span class="comment"># 获取多一个name对应的集合的并集，并将结果保存到dest对应的集合中</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h5 id="Sort-Set-操作"><a href="#Sort-Set-操作" class="headerlink" title="Sort Set 操作"></a><strong>Sort Set 操作</strong></h5><p>有序集合，在集合的基础上，为每元素排序；元素的排序需要根据另外一个值来进行比较，所以，对于有序集合，每一个元素有两个值，即：值和分数，分数专门用来做排序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">zadd(name, *args, **kwargs)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 在 name 对应的有序集合中添加元素</span></span><br><span class="line"><span class="string"> 例如：</span></span><br><span class="line"><span class="string">      zadd(&#x27;something&#x27;, &#x27;n1&#x27;, 1, &#x27;n2&#x27;, 2)</span></span><br><span class="line"><span class="string">      或</span></span><br><span class="line"><span class="string">      zadd(&#x27;something&#x27;, n1=11, n2=22)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">zcard(name)</span><br><span class="line"><span class="comment"># 获取name对应的有序集合元素的数量</span></span><br><span class="line"></span><br><span class="line">zcount(name, <span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line"><span class="comment"># 获取name对应的有序集合中分数 在 [min,max] 之间的个数</span></span><br><span class="line"></span><br><span class="line">zincrby(name, value, amount)</span><br><span class="line"><span class="comment"># 自增name对应的有序集合的 name 对应的分数</span></span><br><span class="line"></span><br><span class="line">r.zrange( name, start, end, desc=<span class="literal">False</span>, withscores=<span class="literal">False</span>, score_cast_func=<span class="built_in">float</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 按照索引范围获取name对应的有序集合的元素</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     start，有序集合索引起始位置（非分数）</span></span><br><span class="line"><span class="string">     end，有序集合索引结束位置（非分数）</span></span><br><span class="line"><span class="string">     desc，排序规则，默认按照分数从小到大排序</span></span><br><span class="line"><span class="string">     withscores，是否获取元素的分数，默认只获取元素的值</span></span><br><span class="line"><span class="string">     score_cast_func，对分数进行数据转换的函数</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 更多：</span></span><br><span class="line"><span class="string">     从大到小排序</span></span><br><span class="line"><span class="string">     zrevrange(name, start, end, withscores=False, score_cast_func=float)</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">     按照分数范围获取name对应的有序集合的元素</span></span><br><span class="line"><span class="string">     zrangebyscore(name, min, max, start=None, num=None, withscores=False, score_cast_func=float)</span></span><br><span class="line"><span class="string">     从大到小排序</span></span><br><span class="line"><span class="string">     zrevrangebyscore(name, max, min, start=None, num=None, withscores=False, score_cast_func=float)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">zrank(name, value)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 获取某个值在 name对应的有序集合中的排行（从 0 开始）</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 更多：</span></span><br><span class="line"><span class="string">     zrevrank(name, value)，从大到小排序</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">zrangebylex(name, <span class="built_in">min</span>, <span class="built_in">max</span>, start=<span class="literal">None</span>, num=<span class="literal">None</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> 当有序集合的所有成员都具有相同的分值时，有序集合的元素会根据成员的 值 （lexicographical ordering）来进行排序，而这个命令则可以返回给定的有序集合键 key 中， 元素的值介于 min 和 max 之间的成员</span></span><br><span class="line"><span class="string"> 对集合中的每个成员进行逐个字节的对比（byte-by-byte compare）， 并按照从低到高的顺序， 返回排序后的集合成员。 如果两个字符串有一部分内容是相同的话， 那么命令会认为较长的字符串比较短的字符串要大</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 参数：</span></span><br><span class="line"><span class="string">     name，redis的name</span></span><br><span class="line"><span class="string">     min，左区间（值）。 + 表示正无限； - 表示负无限； ( 表示开区间； [ 则表示闭区间</span></span><br><span class="line"><span class="string">     min，右区间（值）</span></span><br><span class="line"><span class="string">     start，对结果进行分片处理，索引位置</span></span><br><span class="line"><span class="string">     num，对结果进行分片处理，索引后面的num个元素</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 例子：</span></span><br><span class="line"><span class="string">     ZADD myzset 0 aa 0 ba 0 ca 0 da 0 ea 0 fa 0 ga</span></span><br><span class="line"><span class="string">     r.zrangebylex(&#x27;myzset&#x27;, &quot;-&quot;, &quot;[ca&quot;) 结果为：[&#x27;aa&#x27;, &#x27;ba&#x27;, &#x27;ca&#x27;]</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 扩展：</span></span><br><span class="line"><span class="string">     从大到小排序</span></span><br><span class="line"><span class="string">     zrevrangebylex(name, max, min, start=None, num=None)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">zrem(name, values)</span><br><span class="line"><span class="comment"># 删除name对应的有序集合中值是values的成员</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 如：zrem(&#x27;zz&#x27;, [&#x27;s1&#x27;, &#x27;s2&#x27;])</span></span><br><span class="line"></span><br><span class="line">zremrangebyrank(name, <span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line"><span class="comment"># 根据排行范围删除</span></span><br><span class="line"></span><br><span class="line">zremrangebyscore(name, <span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line"><span class="comment"># 根据分数范围删除</span></span><br><span class="line"></span><br><span class="line">zremrangebylex(name, <span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line"><span class="comment"># 根据值返回删除</span></span><br><span class="line"></span><br><span class="line">zscore(name, value)</span><br><span class="line"><span class="comment"># 获取name对应有序集合中 value 对应的分数</span></span><br><span class="line"></span><br><span class="line">zinterstore(dest, keys, aggregate=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 获取两个有序集合的交集，如果遇到相同值不同分数，则按照aggregate进行操作</span></span><br><span class="line"><span class="comment"># aggregate的值为:  SUM  MIN  MAX</span></span><br><span class="line"></span><br><span class="line">zunionstore(dest, keys, aggregate=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 获取两个有序集合的并集，如果遇到相同值不同分数，则按照aggregate进行操作</span></span><br><span class="line"><span class="comment"># aggregate的值为:  SUM  MIN  MAX</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6、发布和订阅"><a href="#6、发布和订阅" class="headerlink" title="6、发布和订阅"></a>6、发布和订阅</h4><h5 id="1、发布者"><a href="#1、发布者" class="headerlink" title="1、发布者"></a>1、<strong>发布者</strong></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;172.16.153.136&#x27;</span>,</span><br><span class="line">                            port=<span class="number">6379</span>,</span><br><span class="line">                            max_connections=<span class="number">10</span>)</span><br><span class="line">conn = redis.Redis(connection_pool=pool)</span><br><span class="line">conn.publish(<span class="string">&#x27;fm101&#x27;</span>, <span class="string">&#x27;我要上头条&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="2、订阅者"><a href="#2、订阅者" class="headerlink" title="2、订阅者"></a><strong>2、订阅者</strong></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;172.16.153.136&#x27;</span>,</span><br><span class="line">                            port=<span class="number">6379</span>,</span><br><span class="line">                            max_connections=<span class="number">10</span>)</span><br><span class="line">conn = redis.Redis(connection_pool=pool)</span><br><span class="line">pub = conn.pubsub()</span><br><span class="line">pub.subscribe(<span class="string">&#x27;fm101&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = pub.parse_response()</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<h4 id="7、python链接redis操作（作业练习）"><a href="#7、python链接redis操作（作业练习）" class="headerlink" title="7、python链接redis操作（作业练习）"></a>7、python链接redis操作（作业练习）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-py提供两个类Redis和StrictRedis用于实现Redis的命令，StrictRedis用于实现大部分官方的命令，并使用官方的语法和命令，Redis是StrictRedis的子类，用于向后兼容旧版本的redis-py。</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="comment">#创建redis链接对象</span></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#存储键值对</span></span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;site&#x27;</span>,<span class="string">&#x27;www.qi.cn&#x27;</span>)</span><br><span class="line"><span class="comment">#获取值</span></span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;site&#x27;</span>))</span><br><span class="line"><span class="comment">#指定decode_responses为True，表示输出为字符串</span></span><br><span class="line">red = redis.StrictRedis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#默认redis入库编码是utf-8，如果要修改的话，需要指明 charset 和 decode_responsers 为True</span></span><br><span class="line"><span class="comment">#test = redis.StrictRedis(host=&#x27;localhost&#x27;, port=6379, db=0, password=None, socket_timeout=None, connection_pool=None, charset=&#x27;utf-8&#x27;, errors=&#x27;strict&#x27;, decode_responses=False, unix_socket_path=None)</span></span><br><span class="line">red.lpush(<span class="string">&#x27;list1&#x27;</span>,<span class="string">&#x27;mongdb&#x27;</span>,<span class="string">&#x27;redis&#x27;</span>,<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;list1&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(r.llen(<span class="string">&#x27;list1&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">www.qi.cn</span><br><span class="line">[<span class="string">&#x27;mysql&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;mongdb&#x27;</span>]</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>连接池：</p>
<p>redis-py使用connection pool来管理对一个redis server的所有连接，避免每次建立、释放连接的开销。默认，每个Redis实例都会维护一个自己的连接池。可以直接建立一个连接池，然后作为参数Redis，这样就可以实现多个Redis实例共享一个连接池。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="comment">#创建连接池</span></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#创建链接对象</span></span><br><span class="line">r=redis.Redis(connection_pool=pool)</span><br><span class="line"><span class="comment">#设置集合</span></span><br><span class="line">r.sadd(<span class="string">&#x27;set1&#x27;</span>,<span class="string">&#x27;v1&#x27;</span>,<span class="string">&#x27;v2&#x27;</span>,<span class="string">&#x27;v3&#x27;</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;set1&#x27;</span>,<span class="string">&#x27;v2&#x27;</span>)</span><br><span class="line"><span class="comment">#显示集合的值</span></span><br><span class="line"><span class="built_in">print</span>(r.smembers(<span class="string">&#x27;set1&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用strictRedis连接池</span></span><br><span class="line">rs = redis.StrictRedis(connection_pool=pool)</span><br><span class="line">r.lpush(<span class="string">&#x27;l1&#x27;</span>,<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;memcache&#x27;</span>,<span class="string">&#x27;redis&#x27;</span>,<span class="string">&#x27;mongodb&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;l1&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">&#123;<span class="string">&#x27;v3&#x27;</span>, <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;v2&#x27;</span>&#125;</span><br><span class="line">[<span class="string">&#x27;mongodb&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;memcache&#x27;</span>, <span class="string">&#x27;python&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h5 id="（1）数据string操作"><a href="#（1）数据string操作" class="headerlink" title="（1）数据string操作"></a>（1）数据string操作</h5><p>redis中的String在在内存中按照一个name对应一个value来存储的。</p>
<p> set key value [EX seconds] [PX milliseconds] [NX|XX]</p>
<p>参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ex，过期时间（秒）</span><br><span class="line">px，过期时间（毫秒）</span><br><span class="line">nx，如果设置为``<span class="literal">True</span>``，则只有name不存在时，当前``<span class="built_in">set</span>``操作才执行</span><br><span class="line">xx，如果设置为``<span class="literal">True</span>``，则只有name存在时，岗前``<span class="built_in">set</span>``操作才执行</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="comment">#创建连接池</span></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#创建链接对象</span></span><br><span class="line">r=redis.Redis(connection_pool=pool)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;dddddddddddd&#x27;</span>,ex=<span class="number">3</span>,nx=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;test&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>setnx(name,value)：设置值，只有在name不存在是才执行操作</p>
<p>setex(name,value,time)：设置值过期时间，单位为秒</p>
<p>psetex(name,time_ms,value)：设置值，过期时间为毫秒</p>
<p>mset(*args,**kwargs)：批量设置多个值</p>
<p>get(name)：获取值</p>
<p>getrange(key,start,end)：获取子序列,根据字节获取</p>
<p>setrange(name,oofset,value)：修改字符串内容，从指定字符串索引开始向后替换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="comment">#创建连接池</span></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#创建链接对象</span></span><br><span class="line">r=redis.Redis(connection_pool=pool)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;12345&#x27;</span>,nx=<span class="literal">True</span>)</span><br><span class="line">r.setrange(<span class="string">&#x27;test&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;8888&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;test&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>setbit(name,offset,value)：对name对应值的二进制表示的位进行操作</p>
<p>getbit(name,offset)：获取name对应的二进制位表示的值，只能是0或1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r=redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"><span class="comment">#打印p,q对应的ascii码</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">ord</span>(<span class="string">&#x27;p&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>))</span><br><span class="line"><span class="comment">#打印ascii码对应的二进制</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(<span class="built_in">ord</span>(<span class="string">&#x27;p&#x27;</span>)),<span class="built_in">bin</span>(<span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;修改前7位的值：&#x27;</span>,r.getbit(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;7&#x27;</span>))</span><br><span class="line"><span class="comment">#设置二进制位的第7位为1，相当于移动ascii码位112为113对应的字符为q</span></span><br><span class="line">r.setbit(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;修改后7位的值：&#x27;</span>,r.getbit(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;7&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">p</span><br><span class="line"><span class="number">112</span> <span class="number">113</span></span><br><span class="line"><span class="number">0b1110000</span> <span class="number">0b1110001</span></span><br><span class="line">修改前<span class="number">7</span>位的值： <span class="number">0</span></span><br><span class="line">修改后<span class="number">7</span>位的值： <span class="number">1</span></span><br><span class="line">q</span><br></pre></td></tr></table></figure>

<p>strlen(name)：返回name对应值的字节长度，一个汉字3个字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;python&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.strlen(<span class="string">&#x27;name&#x27;</span>))  <span class="comment">#输出6个字节</span></span><br></pre></td></tr></table></figure>

<p>incr(self,name,amount&#x3D;1)：自增name对应的值，当name不存在时，则创建name&#x3D;amount，否则自增</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#r.set(&#x27;name&#x27;,&#x27;python&#x27;)</span></span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.incr(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)) <span class="comment">#结果为4</span></span><br></pre></td></tr></table></figure>

<p>decr(self,name,amount&#x3D;1)：自减 name对应的值，当name不存在时，则创建name＝amount，否则，则自减</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;10&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.decr(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;3&#x27;</span>))  <span class="comment">#输出为7</span></span><br></pre></td></tr></table></figure>

<p>append(key,value)：在name对应的值后面追加内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;10&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;age&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.append(<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;11&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;age&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">1011</span></span><br></pre></td></tr></table></figure>

<h5 id="（2）hash操作"><a href="#（2）hash操作" class="headerlink" title="（2）hash操作"></a>（2）hash操作</h5><p>hset(name,key,value)：在name对应的hash中设置一个键值对，不存在则创建否则修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hset(<span class="string">&#x27;haset&#x27;</span>,<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;3.5&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.hget(<span class="string">&#x27;haset&#x27;</span>,<span class="string">&#x27;python&#x27;</span>))</span><br><span class="line">r.hset(<span class="string">&#x27;haset&#x27;</span>,<span class="string">&#x27;redis&#x27;</span>,<span class="string">&#x27;1.8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;haset&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line"><span class="number">3.5</span></span><br><span class="line">&#123;<span class="string">&#x27;python&#x27;</span>: <span class="string">&#x27;3.5&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>: <span class="string">&#x27;1.8&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>hmset(name,mapping)：在name对应的hash中批量设置键值对</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;v2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;v3&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.hmget(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>hget(name,key)：获取hash中的value</p>
<p>hmget(name,keys,*args)：获取过个hash的key的值</p>
<p>hgetall(name)：获取hash的所有键值对</p>
<p>hlen(name)：获取hash中键值对的个数</p>
<p>hkeys(name)：获取hash中所有keys的值</p>
<p>hvals(name):获取hash中所有value的值</p>
<p>hexists(name,key)：检查hash中是否存在key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;v2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;v3&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.hmget(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hexists(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hexists(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k4&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">[<span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;v2&#x27;</span>, <span class="string">&#x27;v3&#x27;</span>]</span><br><span class="line">&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>, <span class="string">&#x27;k3&#x27;</span>: <span class="string">&#x27;v3&#x27;</span>&#125;</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>hdel(name,*key)：删除hash中的key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;v2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;v3&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hdel(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">&#123;<span class="string">&#x27;k3&#x27;</span>: <span class="string">&#x27;v3&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>, <span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>&#125;</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&#123;<span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>, <span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>hincrby(name,key,amount&#x3D;1)：自增hash中指定的key的值，不存在则创建key&#x3D;amount</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;3&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br><span class="line">r.hincrby(<span class="string">&#x27;hashmore&#x27;</span>,<span class="string">&#x27;k1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>hincrbyfloat(name,key,amount&#x3D;1.0)：自增hash中指定的key的值，同上针对浮点数</p>
<p>hscan(name,cursor&#x3D;0,match&#x3D;None,count&#x3D;None)：增量迭代获取hash中数据，cursor游标，match匹配key默认所有，count获取的个数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;k4&#x27;</span>:<span class="string">&#x27;4&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.hgetall(<span class="string">&#x27;hashmore&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hscan(<span class="string">&#x27;hashmore&#x27;</span>,cursor=<span class="number">2</span>,<span class="keyword">match</span>=<span class="string">&#x27;k2&#x27;</span>,count=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(r.hscan(<span class="string">&#x27;hashmore&#x27;</span>,count=<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br></pre></td></tr></table></figure>

<p>{‘k1’: ‘1’, ‘k3’: ‘3’, ‘k2’: ‘2’, ‘k4’: ‘4’}<br>(0, {‘k2’: ‘2’})<br>(0, {‘k1’: ‘1’, ‘k3’: ‘3’, ‘k2’: ‘2’, ‘k4’: ‘4’})</p>
<p>hscan_iter(name,match&#x3D;None,count&#x3D;None)：利用yield封装hscan创建生成器，实现分批获取数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r= redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.hmset(<span class="string">&#x27;hashmore&#x27;</span>,&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>:<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;k3&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;k4&#x27;</span>:<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;k5&#x27;</span>:<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;k6&#x27;</span>:<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;k7&#x27;</span>:<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;k8&#x27;</span>:<span class="string">&#x27;8&#x27;</span>&#125;)</span><br><span class="line">oo = r.hscan_iter(<span class="string">&#x27;hashmore&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(oo))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(oo))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(oo))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">next</span>(oo))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">(<span class="string">&#x27;k2&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;k7&#x27;</span>, <span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;k8&#x27;</span>, <span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;k5&#x27;</span>, <span class="string">&#x27;5&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="（3）list操作"><a href="#（3）list操作" class="headerlink" title="（3）list操作"></a>（3）list操作</h5><p>lpush(name,values)：在列表中添加元素，每个新元素都从左边开始添加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.lpush(<span class="string">&#x27;l3&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;l3&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line">r.lpush(<span class="string">&#x27;l3&#x27;</span>,<span class="string">&#x27;88&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;l3&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">[<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;88&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>lpushx(name,value)：在列表中添加元素，只有在name存在时才添加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.lpushx(<span class="string">&#x27;l4&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;l4&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line">r.lpush(<span class="string">&#x27;l4&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">r.lpushx(<span class="string">&#x27;l4&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;l4&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">[]</span><br><span class="line">[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>llen(name)：name对应的list元素的长度</p>
<p>linsert(name,where,refvalue,value)：在name对应的列表的某个值前或后插入一个新值，where指定前或后(befor&#x2F;after)，refvalue参考值即指定的元素，value要插入的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.lpush(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">r.linsert(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;after&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;python&#x27;</span>)<span class="comment">#在2后面添加python元素值</span></span><br><span class="line">r.linsert(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;before&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;redis&#x27;</span>) <span class="comment">#在1之前插入redis</span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;num&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">[<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>lset(name,index,value)：对列表中的某个索引位的值修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;num&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line">r.lset(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;num&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">[<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>lrem(name,value,num)：在name对应的list中删除指定的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;num&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line">r.lrem(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)   <span class="comment">#2为num指定的值的个数,可以指定-2从后往前删除</span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;num&#x27;</span>,<span class="number">0</span>,-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>, <span class="string">&#x27;1&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>lpop(name)：在name对应的列表的左侧获取第一个元素并删除，并返回参数的元素</p>
<p>lindex(name,index)：在name对应的列表中根据索引获取列表元素</p>
<p>ltrim(name,start,end)：在name对应的列表中移除start到end之间的值</p>
<p>lrange(name,start,end)：列表分片获取数据</p>
<p>rpoplush(src,dst):获取源列表最后一个元素的值，并将它添加到目标列表中的最左边</p>
<p>blpop(keys,timeout)：将多个列表排列，按照从左到右去pop对应列表的元素</p>
<p>brpoplpush(src,dst,timeout&#x3D;0)：从一个列表的右侧移除一个元素并将其添加到另一个列表的左侧</p>
<h5 id="（4）set操作"><a href="#（4）set操作" class="headerlink" title="（4）set操作"></a>（4）set操作</h5><p>sadd(name,values)：添加元素到集合</p>
<p>scard(name)：获取集合中元素的个数</p>
<p>sdiff(keys,*args)：在第一个集合中的元素且不在其他集合的元素的集合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;s1&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;s2&#x27;</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;s3&#x27;</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r.sdiff(<span class="string">&#x27;s1&#x27;</span>,<span class="string">&#x27;s2&#x27;</span>,<span class="string">&#x27;s3&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output:</span></span><br><span class="line">&#123;<span class="string">&#x27;3&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>sdiffstore(dest,keys,*args)：在第一个keys中的集合元素且不在其他集合中的元素添加到dest新集合中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># r.sadd(&#x27;s1&#x27;,1,2,3)</span></span><br><span class="line"><span class="comment"># r.sadd(&#x27;s2&#x27;,4,5,2)</span></span><br><span class="line"><span class="comment"># r.sadd(&#x27;s3&#x27;,7,8,1)</span></span><br><span class="line"><span class="built_in">print</span>(r.sdiffstore(<span class="string">&#x27;s4&#x27;</span>,<span class="string">&#x27;s1&#x27;</span>,<span class="string">&#x27;s2&#x27;</span>,<span class="string">&#x27;s3&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.smembers(<span class="string">&#x27;s4&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>sinter(keys,*args)：获取多个集合的并集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line"> r.sadd(<span class="string">&#x27;s1&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"> r.sadd(<span class="string">&#x27;s2&#x27;</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(r.sinter(<span class="string">&#x27;s1&#x27;</span>,<span class="string">&#x27;s2&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">&#123;<span class="string">&#x27;2&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>sinterstore(dest,keys,*args)：获取多个集合的并集并将结果加入到dest集合中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;sex1&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;sex2&#x27;</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">7</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;sex3&#x27;</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">r.sinterstore(<span class="string">&#x27;sex4&#x27;</span>,<span class="string">&#x27;sex1&#x27;</span>,<span class="string">&#x27;sex2&#x27;</span>,<span class="string">&#x27;sex3&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.smembers(<span class="string">&#x27;sex4&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line">&#123;<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;2&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>sismember(name,value)：检查value是否在集合中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>,port=<span class="number">6379</span>,decode_responses=<span class="literal">True</span>)</span><br><span class="line">r.sadd(<span class="string">&#x27;sex3&#x27;</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(r.sismember(<span class="string">&#x27;sex3&#x27;</span>,<span class="string">&#x27;8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#output：</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p>smembers(name)：获取集合的所有成员</p>
<p>smove(src,dst,value)：将源集合中的某个成员移动到目标集合中</p>
<p>spop(name)：从集合的右侧（尾部）移除一个成员，并将其返回</p>
<p>srandmember(name,numbers)：从name对应的集合中随机获取 numbers 个元素</p>
<p>srem(name,values)：在name对应的集合中删除某些值</p>
<p>sunion(keys,*args)：并集显示多个集合元素</p>
<p>sunionstore(dest,keys,*args)：获取多一个name对应的集合的并集，并将结果保存到dest对应的集合中</p>
<p>sscan(name,cursor&#x3D;0,match&#x3D;None,count&#x3D;None)：同字符串的操作，用于增量迭代分批获取元素，避免内存消耗太大</p>
<p>sscan_iter(name,match&#x3D;None,count&#x3D;None)：同字符串的操作，用于增量迭代分批获取元素，避免内存消耗太大</p>
<h5 id="（5）有序集合操作"><a href="#（5）有序集合操作" class="headerlink" title="（5）有序集合操作"></a>（5）有序集合操作</h5><p>在集合的基础上，为每个元素排序，元素的排序需要根据另外一个值来进行比较，所以，对于有序集合，每一个元素有两个值，即：值和分数，分数专门用来做排序。</p>
<ul>
<li>zadd(name,*args,**kwargs)：在name对应的有序集合中添加元素</li>
<li>zcard(name)：获取name对应的有序集合元素的数量</li>
<li>zcount(name,min,max)：获取name对应的有序集合中分数 在 [min,max] 之间的个数</li>
<li>zincrby(name,value,amount)：自增name对应的有序集合的 name 对应的分数</li>
<li>r.zrange(name, start, end, desc&#x3D;False, withscores&#x3D;Flase, score_cast_func&#x3D;float)：按照索引范围获取name对应的有序集合的元素</li>
<li>zrank(name, value)：获取某个值在 name对应的有序集合中的排行（从 0 开始）</li>
<li>zrangebylex(name, min, max, start&#x3D;None, num&#x3D;None)：当有序集合的所有成员都具有相同的分值时，有序集合的元素会根据成员的 值</li>
<li>zrem(name, values)：删除name对应的有序集合中值是values的成员</li>
<li>zremrangebyrank(name, min, max)： 根据排行范围删除</li>
<li>zremrangebyscore(name, min, max)：根据分数范围删除</li>
<li>zremrangebylex(name, min, max)：根据值返回删除</li>
<li>zscore(name, values)：获取name对应有序集合中 value 对应的分数</li>
<li>zinterstore(dest, keys, aggregate&#x3D;None)：获取两个有序集合的交集，如果遇到相同值不同分数，则按照aggregate进行操作</li>
<li>zunionstore(dest, keys, aggregate&#x3D;None)：获取两个有序集合的并集，如果遇到相同值不同分数，则按照aggregate进行操作</li>
<li>zscan(name, cursor&#x3D;0, match&#x3D;None, count&#x3D;None, score_cast_func&#x3D;float)：同字符串相似，相较于字符串新增score_cast_func，用来对分数进行操作</li>
<li>zscan_iter(name, match&#x3D;None, count&#x3D;None,score_cast_func&#x3D;float)：同字符串相似，相较于字符串新增score_cast_func，用来对分数进行操作</li>
</ul>
<h5 id="（6）其他操作"><a href="#（6）其他操作" class="headerlink" title="（6）其他操作"></a>（6）其他操作</h5><ul>
<li>delete(*name)：根据删除redis中的任意数据类型</li>
<li>exists(name)：检测redis的name是否存在</li>
<li>keys(pattern&#x3D;’*’)：根据模型获取redis的name</li>
<li>expire(name,time)：为某个redis的某个name设置超时时间</li>
<li>rename(src, dst)：对redis的name重命名为</li>
<li>move(name,db)：将redis的某个值移动到指定的db下</li>
<li>randomkey()：随机获取一个redis的name（不删除）</li>
<li>type(name)：获取name对应值的类型</li>
<li>scan(cursor&#x3D;0,match&#x3D;None,count&#x3D;None)：同字符串操作，用于增量迭代获取key</li>
<li>scan_iter(match&#x3D;None,count&#x3D;None)：同字符串操作，用于增量迭代获取key</li>
</ul>
<h4 id="8、地理位置"><a href="#8、地理位置" class="headerlink" title="8、地理位置"></a>8、地理位置</h4><p><a target="_blank" rel="noopener" href="http://redisdoc.com/topic/cluster-spec.html#cluster-spec">http://redisdoc.com/topic/cluster-spec.html#cluster-spec</a></p>

    </article>
    
    <div class="read-nums">
      <!-- id 将作为查询条件 -->
      <span id="2023/09/26/Redis操作/" class="leancloud_visitors" data-flag-title="Your Article Title">
        <em class="post-meta-item-text">浏览量</em>
        <i class="leancloud-visitors-count"></i>
      </span>
    </div>
    <div class="comments-intro">
      <h2>评论区</h2>
      <p>欢迎你留下宝贵的意见，昵称输入QQ号会显示QQ头像哦~</p>
    </div>
    <div id="vcomments" class="vcomments"></div>
    
  </div>
  <div class="article-catelogue">
    <div class="article-catelogue--wrapper">
      <div class="catelogue catelogue-1">
        <h3>目录</h3>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Python3-%E6%93%8D%E4%BD%9C-Redis"><span class="toc-number">1.</span> <span class="toc-text">Python3 操作 Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">1、简单介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%AE%89%E8%A3%85-redis-%E8%BD%AF%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">2、安装 redis 软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81Redis-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">3、Redis 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9C%A8%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E4%B8%8A%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.1.</span> <span class="toc-text">在远程服务上执行命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81Redis-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text">4、Redis 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81String%EF%BC%88%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、String（字符串）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81Hash%EF%BC%88%E5%93%88%E5%B8%8C%EF%BC%89"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、Hash（哈希）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81List%EF%BC%88%E5%88%97%E8%A1%A8%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">3、List（列表）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81Set%EF%BC%88%E9%9B%86%E5%90%88%EF%BC%89"><span class="toc-number">1.4.4.</span> <span class="toc-text">4、Set（集合）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81sadd-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">1、sadd 命令</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81zset-sorted-set%EF%BC%9A%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88"><span class="toc-number">1.4.5.</span> <span class="toc-text">5、zset(sorted set：有序集合)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1%E3%80%81zadd-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">1、zadd 命令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81Python-%E6%93%8D%E4%BD%9C-Redis"><span class="toc-number">1.5.</span> <span class="toc-text">5、Python 操作 Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">1.5.1.</span> <span class="toc-text">1、安装包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.5.2.</span> <span class="toc-text">2、连接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%E3%80%81%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">1.5.3.</span> <span class="toc-text">3、连接池</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4%E3%80%81%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.4.</span> <span class="toc-text">4、基本操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#String-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.5.</span> <span class="toc-text">String 操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hash-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.6.</span> <span class="toc-text">Hash 操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#List-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.7.</span> <span class="toc-text">List 操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Set-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.8.</span> <span class="toc-text">Set 操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Sort-Set-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.9.</span> <span class="toc-text">Sort Set 操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E5%8F%91%E5%B8%83%E5%92%8C%E8%AE%A2%E9%98%85"><span class="toc-number">1.6.</span> <span class="toc-text">6、发布和订阅</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%E3%80%81%E5%8F%91%E5%B8%83%E8%80%85"><span class="toc-number">1.6.1.</span> <span class="toc-text">1、发布者</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%E3%80%81%E8%AE%A2%E9%98%85%E8%80%85"><span class="toc-number">1.6.2.</span> <span class="toc-text">2、订阅者</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81python%E9%93%BE%E6%8E%A5redis%E6%93%8D%E4%BD%9C%EF%BC%88%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0%EF%BC%89"><span class="toc-number">1.7.</span> <span class="toc-text">7、python链接redis操作（作业练习）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E6%95%B0%E6%8D%AEstring%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.1.</span> <span class="toc-text">（1）数据string操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%882%EF%BC%89hash%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.2.</span> <span class="toc-text">（2）hash操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%883%EF%BC%89list%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.3.</span> <span class="toc-text">（3）list操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%884%EF%BC%89set%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.4.</span> <span class="toc-text">（4）set操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%885%EF%BC%89%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.5.</span> <span class="toc-text">（5）有序集合操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%886%EF%BC%89%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.6.</span> <span class="toc-text">（6）其他操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE"><span class="toc-number">1.8.</span> <span class="toc-text">8、地理位置</span></a></li></ol></li></ol>
      </div>
      
        <div class="catelogue catelogue-2">
          
            <p>
              <span>上一篇：</span>
              <a href="/2023/12/17/nginx1/">nginx1</a>
            </p>
           
          
            <p>
              <span>下一篇</span>
              <a href="/2023/08/17/ansible 模块扩展/">ansible模块</a>
            </p>
          
        </div>
      
    </div>
  </div>
</div>


<script>
  // var定义，避免pjax重新进来造成的重复声明错误
  var config = JSON.parse('{"enable":true,"appId":"Pf8zCXGEH1qsprnWfikVVujL-gzGzoHsz","appKey":"qOqoiUHhH1TGtLRUYURkLRQX","placeholder":"请留下你宝贵的意见吧~","meta":["nick"],"recordIP":true,"visitor":true,"enableQQ":true}')
  new Valine({
    el: '#vcomments',
    appId: config.appId,
    appKey: config.appKey,
    placeholder: config.placeholder,
    meta: config.meta,
    recordIP: config.recordIP,
    visitor: config.visitor,
    enableQQ: config.enableQQ,
    path: '2023/09/26/Redis操作/'
  })
</script>


<script>
  $(document).on('pjax:complete', function() {
    const tocs = document.querySelector('.toc')
    const links = tocs ? tocs.querySelectorAll('a') : []
    links.forEach(link => {
      link.addEventListener('click', e => {
        const href = decodeURIComponent(e.href)
        href.search(/#(.*)/)
        const id = RegExp.$1
        const target = document.querySelector('#' + id)
        const top = target.offsetTop
        document.documentElement.scrollTo({
          top: top - 100,
          behavior: 'smooth'
        })
        e.preventDefault()
      })
    })
  })
</script> 

</div>
      <div class="main-right-wrapper"><div class="main-right">
  <div class="main-right--board">
    <div class="main-right--title">
      <h5>公告栏</h5>
      <i class="iconfont icon-gonggao"></i>
    </div>
    <div class="main-right--content">
      Hello~大噶好。唔系小曹宅，欢迎你们来到我的博客小站，希望能在这里收获到有用的东西哦！ 
    </div>
  </div>

  <div id="aplayer" class="main-right--music"></div>

  <div class="operate-items">
    <div class="operate-item backtop">
      <i class="iconfont icon-huidaodingbu"></i>
      <span>回到顶部</span>
    </div>
    
    <div class="operate-item turn-comment hidden">
      <i class="iconfont icon-pinglun"></i>
      <span>查看评论</span>
    </div>
    
  </div>

  <div class="main-right--site">
    <div class="main-right--power">
      <p>Power By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a>.</p>
      <p>Theme：<a target="_blank" rel="noopener" href="https://github.com/Aizener/hexo-theme-cola">Cola.</a></p>
    </div>
    <p class="main-right--refer"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/index">2262690094</a> </p>
  </div>
</div>

<script>
  function setOperateItem () {
    const reg = /\d{4}\/\d{2}\/\d{2}\/.+/
    const path = location.pathname
    const operateDom = document.querySelector('.main-right .operate-items')
    const commentDom = document.querySelector('.turn-comment')
    const cateloguDom = document.querySelector('.article-catelogue > .article-catelogue--wrapper');

    if (commentDom) {
      if (reg.test(path) || path.match(/\/log\/.+/)) {
        commentDom.classList.remove('hidden')
        const newDom = operateDom.cloneNode(true);
        const _backtopDom = newDom.querySelector('.backtop');
        const _commentDom = newDom.querySelector('.turn-comment');
        _backtopDom.addEventListener('click', () => backTopEvent());
        _commentDom.addEventListener('click', () => commentDomEvent());
        cateloguDom.appendChild(newDom);
      } else {
        commentDom.classList.add('hidden')
      }
    }
  }

  setOperateItem()
  const musics = JSON.parse(`[{"name":"不找了","artist":"隔壁老樊","url":"music/隔壁老樊 - 不找了.mp3","cover":"https://img2.baidu.com/it/u=1260056724,1076343118&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"},{"name":"于是天气刚好","artist":"泪桥","url":"music/于是天气刚好 - 泪桥.mp3","cover":"https://img2.baidu.com/it/u=705831265,2862720033&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"},{"name":"安和桥","artist":"林芬宇","url":"music/林芬宇 - 安和桥.mp3","cover":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQo0SWQx6YrNA8lElaG4OOKLkNkNzLO1PflKg&usqp=CAU"}]`)
  const ap = new APlayer({
    container: document.querySelector('#aplayer'),
    audio: musics,
  })

  $(document).on('pjax:complete', function() {
    setOperateItem()
  })

  document.querySelector('.backtop').addEventListener('click', () => {
    backTopEvent();
  })
  const dom = document.querySelector('.turn-comment')
  dom && dom.addEventListener('click', () => {
    commentDomEvent();
  })

  function backTopEvent() {
    document.documentElement.scrollTo({
      top: 0,
      behavior: 'smooth'
    })
  }

  function commentDomEvent() {
    const commentDom = document.querySelector('.comments-intro')
    if (!commentDom) return
    const top = commentDom.offsetTop, height = commentDom.offsetHeight
    document.documentElement.scrollTo({
      top: top - 2 * height,
      behavior: 'smooth'
    })
  }
</script></div>
    </section>
  </div>
  <div id="progress" class="progress"></div>
  <div id="gray" class="gray"></div>

  <script>
    function initScroll () {
      document.addEventListener('scroll', () => {
        const doc = document.documentElement
        const scrollTop = doc.scrollTop
        const pageHeight = doc.offsetHeight
        const clientHeight = doc.clientHeight
        const ratio = scrollTop / (pageHeight - clientHeight)
        const progress = document.querySelector('#progress')
        const avatarImg = document.querySelector('.main-left--avatar')
        progress.style.width = (100 * ratio) + '%'
        avatarImg.style.transform = `rotate(${360 * ratio}deg)`
      })
    }

    const rootPath = "/"

    const checkAndSetArticlePageLayout = () => {
      const path = location.pathname.replace(rootPath, '');
      if (
        /^\/?\d{4}\/\d{2}\/\d{2}\/.*/.test(path) ||
        /^log\/.+/.test(path)
      ) {
        $('.main-container, .main-right, .main-right-wrapper').addClass('is-article')
      } else {
        $('.main-container, .main-right, .main-right-wrapper').removeClass('is-article')
      }
    }

    const gray = "none"
    const setGrayStyle = () => {
      if (gray === 'none') {
        return
      } else if (gray === 'index') {
        location.pathname === '/' ? $('#gray').show() : $('#gray').hide()
      } else if (gray === 'all') {
        $('#gray').show()
      }
    }
    setGrayStyle()


    window.onload = function () {
      checkAndSetArticlePageLayout()
      setTimeout(() => {
        $('#load').slideUp()
        $('#container').slideToggle()
        setTimeout(() => {
          initScroll();
        }, 500)
      }, 500)
    }
    
    let status = 0
    // 对所有链接跳转事件绑定pjax容器container
    $(document).pjax('a[target!=_blank]', '#main-container', {
      container: '#main-container',
      fragment: '#main-container',
      timeout: 8000
    })

    $(document).on('pjax:start', function() {
    })
    $(document).on('pjax:complete', function() {
      status = 0
      $('.main-container').addClass('to-up').on('animationend', function() {
        $(this).removeClass('to-up')
      })
      setGrayStyle()
      checkAndSetArticlePageLayout()
    })
    $(document).on('pjax:popstate', function() {
      status = -1
      checkAndSetArticlePageLayout()
    });
  </script>
</body>
</html>